# Base runtime (ASP.NET Core 8)
FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS base
WORKDIR /app

# Railway usa porta 8080
ENV ASPNETCORE_URLS=http://0.0.0.0:8080
ENV ASPNETCORE_ENVIRONMENT=Production

# Instala rclone dentro do container
RUN apt-get update && apt-get install -y curl unzip \
 && curl -fsSL https://downloads.rclone.org/rclone-current-linux-amd64.zip -o /tmp/rclone.zip \
 && unzip /tmp/rclone.zip -d /tmp \
 && cp /tmp/rclone-*-linux-amd64/rclone /usr/local/bin/ \
 && chmod +x /usr/local/bin/rclone \
 && rm -rf /var/lib/apt/lists/* /tmp/*

# Copia os arquivos publicados
COPY . .

# Exp√µe a porta
EXPOSE 8080

# Entry point
ENTRYPOINT ["dotnet", "Kanban.dll"]
